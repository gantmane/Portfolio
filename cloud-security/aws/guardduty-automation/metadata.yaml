---
directory: "cloud-security/aws/guardduty-automation"
owner: "Evgeniy Gantman"
purpose: "Multi-account GuardDuty threat detection with automated response"
category: "cloud-security"
subcategory: "threat-detection"

tags:
  - aws
  - guardduty
  - threat-detection
  - incident-response
  - siem-integration
  - automation
  - pci-dss
  - intrusion-detection

resume_alignment:
  key_achievements:
    - metric: "85% incident reduction"
      timeframe: "18 months"
      implementation: "GuardDuty automated threat detection and response"
      impact: "Proactive detection of cryptocurrency mining, backdoors, data exfiltration"
      value: "$250K annual savings in incident response costs"

    - metric: "Real-time threat detection"
      implementation: "GuardDuty monitoring across 15+ AWS accounts"
      coverage: "VPC Flow Logs, CloudTrail, DNS, S3, EKS, RDS"
      response_time: "MTTD < 5 minutes, MTTR < 15 minutes for critical"

    - metric: "SIEM integration"
      implementation: "GuardDuty findings forwarded to Wazuh via Kinesis"
      correlation: "Cross-reference with 500+ custom detection rules"
      retention: "7 years compliance retention"

technical_scope:
  accounts: 15+
  regions: 5
  detection_types:
    - VPC Flow Logs analysis
    - CloudTrail monitoring
    - DNS query analysis
    - S3 data access anomalies
    - EKS audit log monitoring
    - RDS login activity
    - Lambda function monitoring

  automated_responses:
    - EC2 instance isolation
    - Forensic snapshot creation
    - Security group quarantine
    - IAM credential rotation
    - Incident ticket creation
    - PagerDuty alerting

  integrations:
    - Security Hub (finding aggregation)
    - Wazuh SIEM (correlation engine)
    - EventBridge (event routing)
    - SNS (alerting)
    - Kinesis (streaming)
    - Lambda (remediation)

compliance_frameworks:
  pci_dss_4_0:
    requirements:
      - id: "10.6.1"
        description: "Review logs and security events for anomalies"
        implementation: "GuardDuty continuously analyzes VPC Flow, CloudTrail, DNS logs"
        automation: "Real-time detection, no manual review required"

      - id: "10.6.2"
        description: "Review logs of critical system components at least daily"
        implementation: "Automated daily summary reports to security team"
        evidence: "CloudWatch dashboards, S3 archived findings"

      - id: "10.6.3"
        description: "Follow up exceptions and anomalies during review"
        implementation: "EventBridge triggers automated response workflows"
        process: "Critical→auto-isolate, High→alert, Medium→SIEM"

      - id: "10.8.1"
        description: "Timely detection and reporting of failures"
        implementation: "Real-time SNS alerts to PagerDuty for critical findings"
        sla: "< 5 minutes detection, < 15 minutes response"

      - id: "11.4.1"
        description: "Use intrusion-detection techniques"
        implementation: "GuardDuty provides managed IDS/IPS for AWS"
        coverage: "Network, host, application layer monitoring"

      - id: "11.4.2"
        description: "Keep intrusion-detection mechanisms up to date"
        implementation: "AWS automatically updates GuardDuty threat intelligence"
        frequency: "Daily threat feed updates"

  soc2:
    controls:
      - CC6.1: "Logical and physical access controls"
        implementation: "GuardDuty detects unauthorized access attempts"

      - CC6.8: "Restrict access to sensitive information"
        implementation: "S3 protection detects anomalous data access"

      - CC7.2: "System monitoring"
        implementation: "Real-time monitoring of all AWS API calls and network traffic"

dependencies:
  terraform: ">= 1.5"
  aws-cli: ">= 2.0"
  python: ">= 3.11"
  boto3: ">= 1.26"

related_directories:
  - path: "../security-hub-configs"
    relationship: "GuardDuty findings forwarded to Security Hub"

  - path: "../../siem-soc/wazuh-deployment"
    relationship: "Findings forwarded to Wazuh for correlation"

  - path: "../../threat-detection/detection-rules"
    relationship: "Custom detection rules for Wazuh correlation"

  - path: "../../monitoring-observability/grafana-dashboards"
    relationship: "GuardDuty metrics visualized in Grafana"

  - path: "../../incident-response"
    relationship: "Automated response playbooks triggered by findings"

infrastructure:
  terraform_modules:
    - guardduty-config.tf: "Organization-wide GuardDuty setup"
    - threat-intel-integration.tf: "Threat intelligence feeds"
    - suspicious-activity-alerts.tf: "EventBridge rules for critical findings"

  automation_scripts:
    - enable-guardduty.sh: "Multi-account deployment script"
    - guardduty-findings-processor.py: "Lambda for finding enrichment and response"

  configurations:
    - guardduty-suppression-rules.yaml: "False positive suppression"

security_features:
  - Delegated administrator model
  - Multi-region deployment
  - Auto-enable for new accounts
  - Encrypted findings (KMS)
  - Least-privilege IAM roles
  - Audit logging (CloudTrail)
  - 7-year finding retention
  - Threat intelligence integration

operational_metrics:
  mttd: "< 5 minutes"
  mttr_critical: "< 15 minutes (automated)"
  false_positive_rate: "< 5%"
  coverage: "100% of AWS accounts"
  availability: "99.99% (AWS SLA)"
  cost: "$180/month for 15 accounts"

detection_categories:
  network:
    - Port scanning
    - Brute force attacks
    - DDoS activity
    - Unusual traffic patterns
    - C2 communication

  identity:
    - Compromised credentials
    - Privilege escalation
    - Unusual API calls
    - Root account usage

  data:
    - Data exfiltration
    - Anomalous S3 access
    - DNS tunneling
    - Database credential theft

  malware:
    - Cryptocurrency mining
    - Backdoors
    - Trojans
    - Botnets

response_workflows:
  critical_severity:
    - action: "Isolate compromised instance"
      automation: "Lambda modifies security groups"
      timing: "Immediate (< 1 minute)"

    - action: "Create forensic snapshot"
      automation: "Lambda creates EBS snapshot"
      retention: "90 days"

    - action: "Alert security team"
      automation: "SNS to PagerDuty"
      escalation: "Immediate page"

    - action: "Create incident ticket"
      automation: "Lambda creates ServiceNow ticket"
      assignment: "Security team"

  high_severity:
    - action: "Enrich finding with context"
      automation: "Lambda queries AWS APIs, threat intel"

    - action: "Forward to SIEM"
      automation: "Kinesis stream to Wazuh"

    - action: "Notify security team"
      automation: "SNS to Slack channel"

  medium_severity:
    - action: "Forward to SIEM only"
      automation: "Kinesis stream to Wazuh"

threat_intelligence:
  aws_managed:
    - Proofpoint ET Intelligence
    - CrowdStrike Falcon Intelligence

  custom_lists:
    - Company-specific threat indicators
    - Known attacker IPs
    - Malicious domains

  whitelists:
    - Corporate IP ranges
    - Approved security scanners
    - Trusted third-party services

cost_optimization:
  strategies:
    - "S3 protection enabled only for CDE buckets"
    - "GuardDuty disabled in unused regions"
    - "CloudTrail limited to management events"
    - "Volume-based pricing discounts"

  monthly_cost: "$180 for 15 accounts, 5 regions"
  cost_per_account: "$12/month average"

documentation:
  runbooks:
    - "GuardDuty deployment procedure"
    - "Finding investigation workflow"
    - "Automated response troubleshooting"
    - "False positive suppression process"

  policies:
    - "Threat detection and response policy"
    - "Finding severity classification"
    - "Escalation procedures"

last_updated: "2025-12"
version: "2.0"
status: "production"
