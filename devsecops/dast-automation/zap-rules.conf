# ==============================================================================
# OWASP ZAP SCAN CONFIGURATION
# ==============================================================================
# Author: Evgeniy Gantman
# Purpose: ZAP scan rules configuration for baseline and full scans
# Usage: zap-baseline.py -c zap-rules.conf
# ==============================================================================

# IGNORE specific alerts (false positives or accepted risks)

# Ignore CSP warnings on non-production environments
10038	IGNORE	(Content Security Policy)

# Ignore cookie without secure flag on development
10011	IGNORE	(Cookie Without Secure Flag)

# WARN level alerts (report but don't fail build)
10015	WARN	(Re-examine Cache-control Directives)
10027	WARN	(Information Disclosure - Suspicious Comments)
10096	WARN	(Timestamp Disclosure - Unix)

# FAIL level alerts (will fail the build)
10023	FAIL	(Information Disclosure - Debug Error Messages)
10021	FAIL	(X-Content-Type-Options Header Missing)
10020	FAIL	(X-Frame-Options Header)
40012	FAIL	(Cross Site Scripting - Reflected)
40014	FAIL	(Cross Site Scripting - Persistent)
40018	FAIL	(SQL Injection)
90019	FAIL	(Server Side Include)
90020	FAIL	(Remote OS Command Injection)

# ==============================================================================
# SCAN POLICY CONFIGURATION
# ==============================================================================

# Authentication settings (if needed)
# replacer.full_list=
# auth.loginurl=https://staging.company.com/login
# auth.username=test_user
# auth.password=test_password

# Spider settings
# spider.maxDuration=10
# spider.maxChildren=10
# spider.maxDepth=5

# Ajax Spider settings
# ajaxSpider.browserId=firefox-headless
# ajaxSpider.maxDuration=10

# Active scan policy (threshold levels)
# ascan.strength=MEDIUM
# ascan.threshold=MEDIUM

# ==============================================================================
# CONTEXT-SPECIFIC EXCLUDES
# ==============================================================================

# Exclude logout URLs (to avoid logging out during scan)
# ^.*/logout.*

# Exclude admin deletion endpoints
# ^.*/admin/delete/.*

# Exclude payment transaction endpoints (use in staging only)
# ^.*/api/v1/payments/process.*

# Exclude file upload endpoints (to avoid uploading test files)
# ^.*/api/v1/upload.*

# ==============================================================================
# ALERT FILTERS
# ==============================================================================

# Filter out false positives specific to our stack

# Django CSRF token warnings (handled by framework)
# 10010	IGNORE	(Cookie No HttpOnly Flag)	# Django session cookies

# ==============================================================================
# CUSTOM SCAN RULES
# ==============================================================================

# Enable specific scan rules for payment processing
# 40019	ENABLE	(Credit Card Number Disclosure)
# 10105	ENABLE	(Weak Authentication Method)

# ==============================================================================
# REPORTING CONFIGURATION
# ==============================================================================

# Report format and verbosity
# report.format=HTML,JSON,MD
# report.includeDescription=true
# report.includeSolution=true
# report.includeOtherInfo=true

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================
