# Ansible Configuration File
# Author: Evgeniy Gantman
# Purpose: Ansible configuration for security and performance
# Last Updated: 2024-01-15

[defaults]
# Inventory settings
inventory = ./inventories/production/hosts
host_key_checking = True  # Prevent MITM attacks
retry_files_enabled = False

# Performance optimizations
gathering = smart  # Cache facts for better performance
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_fact_cache
fact_caching_timeout = 3600  # Cache facts for 1 hour

# Plugins
callback_whitelist = profile_tasks, timer, yaml  # Performance profiling
stdout_callback = yaml  # Easier to read output

# SSH settings
remote_user = ansible
remote_port = 22
timeout = 30
forks = 10  # Parallel execution (10 servers at a time)

# Logging
log_path = /var/log/ansible.log

# Security settings
private_key_file = ~/.ssh/ansible_key
vault_password_file = ~/.ansible_vault_pass

# Roles path
roles_path = ./roles

# Collections path
collections_paths = ./collections

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False  # Use sudoers NOPASSWD for automation

[ssh_connection]
# SSH connection optimization
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=yes
pipelining = True  # Reduce SSH round-trips (requires sudoers with !requiretty)
control_path = /tmp/ansible-ssh-%%h-%%p-%%r

# SSH retries
retries = 3

[persistent_connection]
# Persistent connection timeout
connect_timeout = 30
command_timeout = 30

[inventory]
# Inventory plugins
enable_plugins = aws_ec2, gcp_compute, azure_rm, yaml, ini

# Cache settings
cache = True
cache_plugin = jsonfile
cache_connection = /tmp/ansible_inventory_cache
cache_timeout = 3600

[colors]
# Color output
highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan
